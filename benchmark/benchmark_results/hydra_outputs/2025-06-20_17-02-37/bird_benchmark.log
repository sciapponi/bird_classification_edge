[2025-06-20 17:02:40,977][__main__][INFO] - üìÅ Timestamped benchmark directory: 2025-06-20_17-02-40
[2025-06-20 17:02:40,983][__main__][INFO] -    Predictions: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/predictions
[2025-06-20 17:02:40,984][__main__][INFO] -    Comparison: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison
[2025-06-20 17:02:40,986][__main__][INFO] - ============================================================
[2025-06-20 17:02:40,986][__main__][INFO] - üéØ ALIGNED BIRD CLASSIFICATION BENCHMARK
[2025-06-20 17:02:40,987][__main__][INFO] - ============================================================
[2025-06-20 17:02:40,989][__main__][INFO] - üîß FAIR COMPARISON MODE:
[2025-06-20 17:02:40,991][__main__][INFO] -    ‚Ä¢ BirdNET: Uses 3s segments with student model preprocessing
[2025-06-20 17:02:40,993][__main__][INFO] -    ‚Ä¢ Student: Uses same 3s segments and preprocessing
[2025-06-20 17:02:40,994][__main__][INFO] -    ‚Ä¢ Both models see identical audio data
[2025-06-20 17:02:40,998][__main__][INFO] - üîß ADAPTIVE THRESHOLDS: no_birds threshold = 0.45
[2025-06-20 17:02:41,000][__main__][INFO] - ============================================================
[2025-06-20 17:02:41,001][__main__][INFO] - Working directory: /workspace/benchmark/benchmark_results/hydra_outputs/2025-06-20_17-02-37
[2025-06-20 17:02:41,002][__main__][INFO] - Hydra output directory: /workspace/benchmark/benchmark_results/hydra_outputs/2025-06-20_17-02-37
[2025-06-20 17:02:41,002][__main__][INFO] - 
========================================
[2025-06-20 17:02:41,003][__main__][INFO] - üìÅ STEP 1: Audio Discovery
[2025-06-20 17:02:41,010][__main__][INFO] - ========================================
[2025-06-20 17:02:41,013][__main__][INFO] - Scanning bird dataset: /workspace/bird_sound_dataset
[2025-06-20 17:02:41,034][__main__][INFO] - Processing species: Poecile_montanus
[2025-06-20 17:02:41,096][__main__][INFO] - Limited Poecile_montanus to 3 files
[2025-06-20 17:02:41,097][__main__][INFO] - Found 3 files for Poecile_montanus
[2025-06-20 17:02:41,098][__main__][INFO] - Processing species: Certhia_familiaris
[2025-06-20 17:02:41,161][__main__][INFO] - Limited Certhia_familiaris to 3 files
[2025-06-20 17:02:41,162][__main__][INFO] - Found 3 files for Certhia_familiaris
[2025-06-20 17:02:41,164][__main__][INFO] - Processing species: Apus_apus
[2025-06-20 17:02:41,201][__main__][INFO] - Limited Apus_apus to 3 files
[2025-06-20 17:02:41,201][__main__][INFO] - Found 3 files for Apus_apus
[2025-06-20 17:02:41,202][__main__][INFO] - Processing species: Bubo_bubo
[2025-06-20 17:02:41,232][__main__][INFO] - Limited Bubo_bubo to 3 files
[2025-06-20 17:02:41,232][__main__][INFO] - Found 3 files for Bubo_bubo
[2025-06-20 17:02:41,234][__main__][INFO] - Scanning no_birds dataset: /workspace/augmented_dataset/no_birds
[2025-06-20 17:02:41,256][__main__][INFO] - Limited no_birds to 3 files
[2025-06-20 17:02:41,257][__main__][INFO] - Found 3 no_birds files
[2025-06-20 17:02:41,260][__main__][INFO] - Total audio files discovered: 15
[2025-06-20 17:02:41,265][__main__][INFO] - Class distribution:
[2025-06-20 17:02:41,265][__main__][INFO] -   Poecile_montanus: 3 files
[2025-06-20 17:02:41,266][__main__][INFO] -   Certhia_familiaris: 3 files
[2025-06-20 17:02:41,267][__main__][INFO] -   Apus_apus: 3 files
[2025-06-20 17:02:41,267][__main__][INFO] -   Bubo_bubo: 3 files
[2025-06-20 17:02:41,267][__main__][INFO] -   no_birds: 3 files
[2025-06-20 17:02:41,278][__main__][INFO] - ‚úÖ Ground truth saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/predictions/ground_truth.csv
[2025-06-20 17:02:41,279][__main__][INFO] - 
========================================
[2025-06-20 17:02:41,279][__main__][INFO] - ü§ñ STEP 2: Student Model Predictions
[2025-06-20 17:02:41,280][__main__][INFO] - ========================================
[2025-06-20 17:02:41,280][__main__][INFO] - Starting student model predictions
[2025-06-20 17:02:43,042][matplotlib.font_manager][INFO] - generated new fontManager
[2025-06-20 17:02:43,548][benchmark.predict_student][INFO] - Environment CUDA_VISIBLE_DEVICES: ''
[2025-06-20 17:02:43,550][benchmark.predict_student][INFO] - PyTorch CUDA available: False
[2025-06-20 17:02:43,551][benchmark.predict_student][INFO] - Using device: cpu
[2025-06-20 17:02:43,609][benchmark.predict_student][INFO] - Loaded configuration from: /workspace/config/bird_classification.yaml
[2025-06-20 17:02:43,774][benchmark.predict_student][INFO] - Loaded model from: /workspace/best_distillation_model.pt
[2025-06-20 17:02:43,783][benchmark.predict_student][INFO] - Student model initialized with 9 classes
[2025-06-20 17:02:43,784][benchmark.predict_student][INFO] - Classes: ['Bubo_bubo', 'Certhia_familiaris', 'Apus_apus', 'Certhia_brachydactyla', 'Emberiza_cia', 'Lophophanes_cristatus', 'Periparus_ater', 'Poecile_montanus', 'no_birds']
[2025-06-20 17:02:43,785][benchmark.predict_student][INFO] - Confidence threshold: 0.1
[2025-06-20 17:03:06,311][benchmark.predict_student][WARNING] - No calls detected in /workspace/benchmark/../augmented_dataset/no_birds/esc50_0009.wav, using fallback preprocessing
[2025-06-20 17:03:06,614][benchmark.predict_student][WARNING] - No calls detected in /workspace/benchmark/../augmented_dataset/no_birds/empty_0374.wav, using fallback preprocessing
[2025-06-20 17:03:07,005][__main__][INFO] - Student predictions saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/predictions/student_predictions.csv
[2025-06-20 17:03:07,026][__main__][INFO] - ‚úÖ Student prediction completed
[2025-06-20 17:03:07,027][__main__][INFO] -   Total predictions: 15
[2025-06-20 17:03:07,032][__main__][INFO] -   Average confidence: 0.644
[2025-06-20 17:03:07,033][__main__][INFO] -   Top prediction: Certhia_familiaris (4 files)
[2025-06-20 17:03:07,041][__main__][INFO] - 
========================================
[2025-06-20 17:03:07,041][__main__][INFO] - ü¶Ö STEP 3: BirdNET Aligned Predictions
[2025-06-20 17:03:07,042][__main__][INFO] - ========================================
[2025-06-20 17:03:07,042][__main__][INFO] - Starting BirdNET predictions with ALIGNED preprocessing and ADAPTIVE THRESHOLDS
[2025-06-20 17:03:07,043][__main__][INFO] - üéØ Using identical preprocessing pipeline as student model:
[2025-06-20 17:03:07,043][__main__][INFO] -    - Segment duration: 3.0s
[2025-06-20 17:03:07,044][__main__][INFO] -    - Sample rate: 32000 Hz
[2025-06-20 17:03:07,044][__main__][INFO] -    - Bandpass filter: 150.0-16000.0 Hz
[2025-06-20 17:03:07,046][__main__][INFO] -    - Extract calls: True
[2025-06-20 17:03:07,047][__main__][INFO] - üîß Threshold configuration:
[2025-06-20 17:03:07,048][__main__][INFO] -    - Basic confidence threshold: 0.3
[2025-06-20 17:03:07,049][__main__][INFO] -    - No-birds threshold: 0.45
[2025-06-20 17:03:07,049][__main__][INFO] -    - Adaptive threshold enabled: True
[2025-06-20 17:03:07,050][__main__][INFO] -    - Adaptive factor: 1.5x
[2025-06-20 17:03:07,135][benchmark.predict_birdnet][INFO] - BirdNET initialized with 8 target species
[2025-06-20 17:03:07,135][benchmark.predict_birdnet][INFO] - Target species: ['Bubo_bubo', 'Certhia_familiaris', 'Apus_apus', 'Certhia_brachydactyla', 'Emberiza_cia', 'Lophophanes_cristatus', 'Periparus_ater', 'Poecile_montanus']
[2025-06-20 17:03:07,137][benchmark.predict_birdnet][INFO] - Confidence threshold: 0.3
[2025-06-20 17:03:07,138][benchmark.predict_birdnet][INFO] - Segmented mode: True, Duration: 3.0s
[2025-06-20 17:03:07,139][benchmark.predict_birdnet][INFO] - Using BirdNET prediction method: aligned (3s segments)
[2025-06-20 17:03:12,739][benchmark.predict_birdnet][WARNING] - Filter frequencies too high for sample rate 32000
[2025-06-20 17:03:12,996][benchmark.predict_birdnet][WARNING] - Filter frequencies too high for sample rate 32000
[2025-06-20 17:03:13,113][benchmark.predict_birdnet][WARNING] - Filter frequencies too high for sample rate 32000
[2025-06-20 17:03:13,260][__main__][INFO] - BirdNET predictions saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/predictions/birdnet_predictions.csv
[2025-06-20 17:03:13,274][__main__][INFO] - ‚úÖ BirdNET ALIGNED prediction completed
[2025-06-20 17:03:13,275][__main__][INFO] -   Total predictions: 15
[2025-06-20 17:03:13,280][__main__][INFO] -   Average confidence: 0.575
[2025-06-20 17:03:13,281][__main__][INFO] -   Top prediction: no_birds (6 files)
[2025-06-20 17:03:13,284][__main__][INFO] -   Preprocessing methods used:
[2025-06-20 17:03:13,285][__main__][INFO] -     extract_calls: 15 files
[2025-06-20 17:03:13,287][benchmark.predict_birdnet][INFO] - Cleaned up temporary species list file
[2025-06-20 17:03:13,319][__main__][INFO] - 
========================================
[2025-06-20 17:03:13,320][__main__][INFO] - üìä STEP 4: Metrics and Comparison
[2025-06-20 17:03:13,321][__main__][INFO] - ========================================
[2025-06-20 17:03:13,322][__main__][INFO] - Starting model comparison
[2025-06-20 17:03:13,351][__main__][INFO] - Comparing 15 predictions
[2025-06-20 17:03:13,358][benchmark.compare_predictions][INFO] - Comparing model predictions
[2025-06-20 17:03:13,476][benchmark.compare_predictions][INFO] - JSON report saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison/comparison_report.json
[2025-06-20 17:03:13,480][benchmark.compare_predictions][INFO] - Text summary saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison/comparison_summary.txt
[2025-06-20 17:03:13,485][benchmark.compare_predictions][INFO] - Detailed cases saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison/detailed_cases.csv
[2025-06-20 17:03:13,491][benchmark.compare_predictions][INFO] - Metrics comparison table saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison/metrics_comparison_table.csv
[2025-06-20 17:03:13,499][benchmark.compare_predictions][INFO] - Per-class metrics table saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison/per_class_metrics_table.csv
[2025-06-20 17:03:16,167][benchmark.compare_predictions][INFO] - Confusion matrices saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison/confusion_matrices.png
[2025-06-20 17:03:17,157][benchmark.compare_predictions][INFO] - Agreement analysis saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison/agreement_analysis.png
[2025-06-20 17:03:17,877][benchmark.compare_predictions][INFO] - Per-class comparison saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison/per_class_accuracy.png
[2025-06-20 17:03:23,826][benchmark.compare_predictions][INFO] - Comprehensive metrics comparison saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison/comprehensive_metrics_comparison.png
[2025-06-20 17:03:23,831][__main__][INFO] - Comparison results saved to: /workspace/benchmark/benchmark_results/2025-06-20_17-02-40/comparison
[2025-06-20 17:03:23,836][__main__][INFO] - 
============================================================
[2025-06-20 17:03:23,837][__main__][INFO] - üéâ ALIGNED BENCHMARK COMPLETED SUCCESSFULLY!
[2025-06-20 17:03:23,838][__main__][INFO] - ============================================================
[2025-06-20 17:03:23,839][__main__][INFO] - ‚úÖ Fair comparison achieved:
[2025-06-20 17:03:23,843][__main__][INFO] -    ‚Ä¢ Both models used identical preprocessing
[2025-06-20 17:03:23,843][__main__][INFO] -    ‚Ä¢ Both models analyzed same 3-second segments
[2025-06-20 17:03:23,844][__main__][INFO] -    ‚Ä¢ Performance gap should be <5% (realistic)
[2025-06-20 17:03:23,847][__main__][INFO] - üìä Check results/comparison/ for detailed analysis
[2025-06-20 17:03:23,847][__main__][INFO] - ============================================================
