[2025-06-23 15:37:22,722][__main__][INFO] - üìÅ Timestamped benchmark directory: 2025-06-23_15-37-22
[2025-06-23 15:37:22,723][__main__][INFO] -    Predictions: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/predictions
[2025-06-23 15:37:22,724][__main__][INFO] -    Comparison: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison
[2025-06-23 15:37:22,724][__main__][INFO] - ============================================================
[2025-06-23 15:37:22,725][__main__][INFO] - üéØ ALIGNED BIRD CLASSIFICATION BENCHMARK
[2025-06-23 15:37:22,725][__main__][INFO] - ============================================================
[2025-06-23 15:37:22,725][__main__][INFO] - üîß FAIR COMPARISON MODE:
[2025-06-23 15:37:22,725][__main__][INFO] -    ‚Ä¢ BirdNET: Uses 3s segments with student model preprocessing
[2025-06-23 15:37:22,725][__main__][INFO] -    ‚Ä¢ Student: Uses same 3s segments and preprocessing
[2025-06-23 15:37:22,725][__main__][INFO] -    ‚Ä¢ Both models see identical audio data
[2025-06-23 15:37:22,726][__main__][INFO] - üéØ BIRDS-ONLY MODE: Excluding no_birds class from evaluation
[2025-06-23 15:37:22,726][__main__][INFO] - ============================================================
[2025-06-23 15:37:22,726][__main__][INFO] - Working directory: /workspace/benchmark/benchmark_results/hydra_outputs/2025-06-23_15-37-21
[2025-06-23 15:37:22,726][__main__][INFO] - Hydra output directory: /workspace/benchmark/benchmark_results/hydra_outputs/2025-06-23_15-37-21
[2025-06-23 15:37:22,727][__main__][INFO] - 
========================================
[2025-06-23 15:37:22,727][__main__][INFO] - üìÅ STEP 1: Audio Discovery
[2025-06-23 15:37:22,727][__main__][INFO] - ========================================
[2025-06-23 15:37:22,727][__main__][INFO] - Scanning bird dataset: /workspace/bird_sound_dataset
[2025-06-23 15:37:22,729][__main__][INFO] - Processing species: Poecile_montanus
[2025-06-23 15:37:22,830][__main__][INFO] - Found 1248 files for Poecile_montanus
[2025-06-23 15:37:22,832][__main__][INFO] - Processing species: Certhia_familiaris
[2025-06-23 15:37:22,870][__main__][INFO] - Found 1325 files for Certhia_familiaris
[2025-06-23 15:37:22,872][__main__][INFO] - Processing species: Apus_apus
[2025-06-23 15:37:22,898][__main__][INFO] - Found 807 files for Apus_apus
[2025-06-23 15:37:22,898][__main__][INFO] - Processing species: Bubo_bubo
[2025-06-23 15:37:22,921][__main__][INFO] - Found 860 files for Bubo_bubo
[2025-06-23 15:37:22,921][__main__][INFO] - üéØ BIRDS-ONLY MODE: Excluding no_birds samples from ground truth
[2025-06-23 15:37:22,935][__main__][INFO] - üîç LIMITED TO 100 files for testing
[2025-06-23 15:37:22,936][__main__][INFO] - Total audio files discovered: 99
[2025-06-23 15:37:22,936][__main__][INFO] - Class distribution:
[2025-06-23 15:37:22,936][__main__][INFO] -   Certhia_familiaris: 31 files
[2025-06-23 15:37:22,936][__main__][INFO] -   Poecile_montanus: 29 files
[2025-06-23 15:37:22,937][__main__][INFO] -   Bubo_bubo: 20 files
[2025-06-23 15:37:22,937][__main__][INFO] -   Apus_apus: 19 files
[2025-06-23 15:37:22,946][__main__][INFO] - ‚úÖ Ground truth saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/predictions/ground_truth.csv
[2025-06-23 15:37:22,946][__main__][INFO] - 
========================================
[2025-06-23 15:37:22,947][__main__][INFO] - ü§ñ STEP 2: Student Model Predictions
[2025-06-23 15:37:22,947][__main__][INFO] - ========================================
[2025-06-23 15:37:22,947][__main__][INFO] - Starting student model predictions
[2025-06-23 15:37:23,776][matplotlib.font_manager][INFO] - generated new fontManager
[2025-06-23 15:37:24,017][benchmark.predict_student][INFO] - Environment CUDA_VISIBLE_DEVICES: ''
[2025-06-23 15:37:24,018][benchmark.predict_student][INFO] - PyTorch CUDA available: False
[2025-06-23 15:37:24,018][benchmark.predict_student][INFO] - Using device: cpu
[2025-06-23 15:37:24,029][benchmark.predict_student][INFO] - Loaded configuration from: /workspace/config/bird_classification.yaml
[2025-06-23 15:37:24,153][benchmark.predict_student][INFO] - Loaded model from: /workspace/best_distillation_model.pt
[2025-06-23 15:37:24,158][benchmark.predict_student][INFO] - Student model initialized with 9 classes
[2025-06-23 15:37:24,159][benchmark.predict_student][INFO] - Classes: ['Bubo_bubo', 'Certhia_familiaris', 'Apus_apus', 'Certhia_brachydactyla', 'Emberiza_cia', 'Lophophanes_cristatus', 'Periparus_ater', 'Poecile_montanus', 'no_birds']
[2025-06-23 15:37:24,159][benchmark.predict_student][INFO] - Confidence threshold: 0.05
[2025-06-23 15:37:40,186][benchmark.predict_student][WARNING] - No calls detected in /workspace/benchmark/../bird_sound_dataset/Apus_apus/XC910923-Swift-06-06-24.mp3, using fallback preprocessing
[2025-06-23 15:37:40,730][benchmark.predict_student][WARNING] - No calls detected in /workspace/benchmark/../bird_sound_dataset/Bubo_bubo/XC956188-241129_0395-Uhu-(M&W)-BuHo-1715-(sehr-leise).mp3, using fallback preprocessing
[2025-06-23 15:37:47,648][benchmark.predict_student][WARNING] - No calls detected in /workspace/benchmark/../bird_sound_dataset/Certhia_familiaris/XC129288-8031_11.04.2013, –ù. –ê–∑—è–ø–æ–≤–æ, 9-25, –∫–æ—Ä–æ–ª–µÃà–∫ –°.mp3, using fallback preprocessing
[2025-06-23 15:37:55,856][benchmark.predict_student][WARNING] - No calls detected in /workspace/benchmark/../bird_sound_dataset/Poecile_montanus/XC438295-B10h09m21s15may2018_plus_37m51s_WillowTit_song_VolUpHighPass.mp3, using fallback preprocessing
[2025-06-23 15:37:56,086][benchmark.predict_student][WARNING] - No calls detected in /workspace/benchmark/../bird_sound_dataset/Poecile_montanus/XC540988-WillowTitCall Bagmere 1327pm 11022019.mp3, using fallback preprocessing
[2025-06-23 15:37:56,737][__main__][INFO] - Student predictions saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/predictions/student_predictions.csv
[2025-06-23 15:37:56,744][__main__][INFO] - ‚úÖ Student prediction completed
[2025-06-23 15:37:56,744][__main__][INFO] -   Total predictions: 99
[2025-06-23 15:37:56,745][__main__][INFO] -   Average confidence: 0.612
[2025-06-23 15:37:56,745][__main__][INFO] -   Top prediction: Certhia_familiaris (24 files)
[2025-06-23 15:37:56,750][__main__][INFO] - 
========================================
[2025-06-23 15:37:56,750][__main__][INFO] - ü¶Ö STEP 3: BirdNET Aligned Predictions
[2025-06-23 15:37:56,751][__main__][INFO] - ========================================
[2025-06-23 15:37:56,751][__main__][INFO] - Starting BirdNET predictions with ALIGNED preprocessing and ADAPTIVE THRESHOLDS
[2025-06-23 15:37:56,751][__main__][INFO] - üéØ Using identical preprocessing pipeline as student model:
[2025-06-23 15:37:56,752][__main__][INFO] -    - Segment duration: 3.0s
[2025-06-23 15:37:56,752][__main__][INFO] -    - Sample rate: 32000 Hz
[2025-06-23 15:37:56,752][__main__][INFO] -    - Bandpass filter: 150.0-15000.0 Hz
[2025-06-23 15:37:56,752][__main__][INFO] -    - Extract calls: True
[2025-06-23 15:37:56,752][__main__][INFO] - üîß Threshold configuration:
[2025-06-23 15:37:56,753][__main__][INFO] -    - Basic confidence threshold: 0.1
[2025-06-23 15:37:56,753][__main__][INFO] -    - No-birds threshold: 0.3
[2025-06-23 15:37:56,753][__main__][INFO] -    - Adaptive threshold enabled: False
[2025-06-23 15:37:56,803][benchmark.predict_birdnet][INFO] - BirdNET initialized with 8 target species
[2025-06-23 15:37:56,803][benchmark.predict_birdnet][INFO] - Target species: ['Bubo_bubo', 'Certhia_familiaris', 'Apus_apus', 'Certhia_brachydactyla', 'Emberiza_cia', 'Lophophanes_cristatus', 'Periparus_ater', 'Poecile_montanus']
[2025-06-23 15:37:56,803][benchmark.predict_birdnet][INFO] - Confidence threshold: 0.1
[2025-06-23 15:37:56,803][benchmark.predict_birdnet][INFO] - Segmented mode: True, Duration: 3.0s
[2025-06-23 15:37:56,803][benchmark.predict_birdnet][INFO] - Using BirdNET prediction method: aligned (3s segments)
[2025-06-23 15:38:22,693][__main__][INFO] - BirdNET predictions saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/predictions/birdnet_predictions.csv
[2025-06-23 15:38:22,695][__main__][INFO] - ‚úÖ BirdNET ALIGNED prediction completed
[2025-06-23 15:38:22,695][__main__][INFO] -   Total predictions: 99
[2025-06-23 15:38:22,696][__main__][INFO] -   Average confidence: 0.619
[2025-06-23 15:38:22,696][__main__][INFO] -   Top prediction: no_birds (24 files)
[2025-06-23 15:38:22,696][__main__][INFO] -   Preprocessing methods used:
[2025-06-23 15:38:22,696][__main__][INFO] -     extract_calls: 99 files
[2025-06-23 15:38:22,697][benchmark.predict_birdnet][INFO] - Cleaned up temporary species list file
[2025-06-23 15:38:22,709][__main__][INFO] - 
========================================
[2025-06-23 15:38:22,709][__main__][INFO] - üìä STEP 4: Metrics and Comparison
[2025-06-23 15:38:22,710][__main__][INFO] - ========================================
[2025-06-23 15:38:22,710][__main__][INFO] - Starting model comparison
[2025-06-23 15:38:22,713][benchmark.compare_predictions][INFO] - ModelComparator initialized with exclude_classes: ['no_birds']
[2025-06-23 15:38:22,714][benchmark.compare_predictions][INFO] - Birds-only mode: False
[2025-06-23 15:38:22,724][__main__][INFO] - Comparing 99 predictions
[2025-06-23 15:38:22,724][benchmark.compare_predictions][INFO] - Comparing model predictions
[2025-06-23 15:38:22,724][benchmark.compare_predictions][INFO] - Applying class filtering - exclude_classes: ['no_birds'], birds_only: False
[2025-06-23 15:38:22,724][benchmark.compare_predictions][INFO] - Filtering out classes: {'no_birds'}
[2025-06-23 15:38:22,725][benchmark.compare_predictions][INFO] - Samples before filtering: 99
[2025-06-23 15:38:22,726][benchmark.compare_predictions][INFO] - Samples after filtering: 99
[2025-06-23 15:38:22,726][benchmark.compare_predictions][INFO] - After filtering: 99 samples remaining
[2025-06-23 15:38:22,726][benchmark.compare_predictions][INFO] - Classes in analysis: ['Apus_apus', 'Bubo_bubo', 'Certhia_brachydactyla', 'Certhia_familiaris', 'Lophophanes_cristatus', 'Periparus_ater', 'Poecile_montanus', 'no_birds']
[2025-06-23 15:38:22,760][benchmark.compare_predictions][INFO] - JSON report saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison/comparison_report.json
[2025-06-23 15:38:22,761][benchmark.compare_predictions][INFO] - Text summary saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison/comparison_summary.txt
[2025-06-23 15:38:22,764][benchmark.compare_predictions][INFO] - Detailed cases saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison/detailed_cases.csv
[2025-06-23 15:38:22,765][benchmark.compare_predictions][INFO] - Metrics comparison table saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison/metrics_comparison_table.csv
[2025-06-23 15:38:22,767][benchmark.compare_predictions][INFO] - Per-class metrics table saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison/per_class_metrics_table.csv
[2025-06-23 15:38:23,469][benchmark.compare_predictions][INFO] - Confusion matrices saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison/confusion_matrices.png
[2025-06-23 15:38:23,851][benchmark.compare_predictions][INFO] - Agreement analysis saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison/agreement_analysis.png
[2025-06-23 15:38:24,142][benchmark.compare_predictions][INFO] - Per-class comparison saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison/per_class_accuracy.png
[2025-06-23 15:38:25,325][benchmark.compare_predictions][INFO] - Comprehensive metrics comparison saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison/comprehensive_metrics_comparison.png
[2025-06-23 15:38:25,326][__main__][INFO] - Comparison results saved to: /workspace/benchmark/benchmark_results/2025-06-23_15-37-22/comparison
[2025-06-23 15:38:25,327][__main__][INFO] - 
============================================================
[2025-06-23 15:38:25,327][__main__][INFO] - üéâ ALIGNED BENCHMARK COMPLETED SUCCESSFULLY!
[2025-06-23 15:38:25,327][__main__][INFO] - ============================================================
[2025-06-23 15:38:25,328][__main__][INFO] - ‚úÖ Fair comparison achieved:
[2025-06-23 15:38:25,328][__main__][INFO] -    ‚Ä¢ Both models used identical preprocessing
[2025-06-23 15:38:25,328][__main__][INFO] -    ‚Ä¢ Both models analyzed same 3-second segments
[2025-06-23 15:38:25,328][__main__][INFO] -    ‚Ä¢ Performance gap should be <5% (realistic)
[2025-06-23 15:38:25,328][__main__][INFO] - üìä Check results/comparison/ for detailed analysis
[2025-06-23 15:38:25,329][__main__][INFO] - ============================================================
